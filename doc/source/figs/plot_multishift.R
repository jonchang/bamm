

# load(BAMMtools);
library(gplots);
library(RColorBrewer);


#
# We will use the pre-loaded event data for the whales:
#
#data(events.cetaceans); # here is the event data
#data(cetaceans); # here is the whale tree

# Process the event data in a bamm-data object:
bammdata <- getEventData(cetaceans, events.cetaceans);

class(bammdata);  # check: should be phylo and bamm-data


# We will plot the 1st, 30th, and 40th samples from the posterior.

ixx <- rep(c(10, 30, 40), 3);


# Set up the plot windows
par(mar=numeric(4));
quartz.options(height=10, width=10, dpi=72);
plot.new();
par(mfrow=c(3,3));
 
# Here we set up the color schemes 
colschemes <- list();
colschemes[1:3] <- 'temperature';
colschemes[4:6] <- 'Spectral';
colschemes[7:9] <- list(c('blue', 'gray', 'red'));


for (i in 1:length(ixx)){
#for (i in 1:3){
		

	index <- ixx[i];
	
	eventsub <- subsetEventData(bammdata, index=index);
	plot.dtrates(eventsub, method='polar', pal= colschemes[[i]], multi=T);
	addBAMMshifts(eventsub, method='polar', index=1, col='white', bg='black', cex=4, multi=T);
	
}











